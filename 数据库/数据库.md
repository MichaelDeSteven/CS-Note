# 数据库系统原理

## 基本概念

**数据库的定义**

数据库是**长期**存储在计算机内，有组织可**共享**的**大量**数据集合
数据库数据具有三个基本特点永久存储、有组织、共享



**数据库的优点**

最开始，我们是将数据保存在内存中，这能够保证我们十分快速存取，但是一旦断电，数据就丢失了，无法永久保存。 于是我们将数据存放在文件中，这样一来我们就 能够将数据永久保存，但每次都要进行频繁的 IO 操作，相对于内存来讲速度就慢了许多，而且进行查询操作也不方便。 于是，我们转移到了数据库存储，通过这种方式不但能将永久保存数据，而且查询管理也更加高效方便。





**数据库管理系统**

![image-20210119164302804](C:\Users\Steven\Desktop\复盘\mysql体系结构.png)

1. 位于用户与操作系统之间的一层数据软件
2. 是一个大型复杂的软件系统

作用：科学地组织、存储数据，高效地获取、维护数据



## 数据模型

数据库结构的基础是数据模型。数据模型是一个描述数据、数据联系、数据语义以及一致性约束的概念工具的集合。数据模型提供了一种描述物理层、逻辑层以及视图层设计方式



### 物理数据模型

物理数据模型简称物理模型，它是面向计算机物理表示的模型。描述了数据与存储介质上的组织结构，他不但与DBMS有关，而且与操作系统和硬件有关。每一种逻辑数据模型都有对应的物理数据模型。DBMS为了保证其独立性与可移植性。大部分物理数据模型的实现工作由系统自动完成，而设计者只设计索引、聚集等特殊结构



### 概念数据模型

**基本概念**

包括重要的实体与实体之间的关系。在概念数据模型中不包括实体的属性，也不用定义实体的主键。这是概念模型与逻辑模型的最大区别。表示概念模型最常用的有实体关系图



### 逻辑数据模型

#### 层次模型

![image-20210119175031483](C:\Users\Steven\Desktop\复盘\层次模型.png)

#### 网状模型

![image-20210119175040827](C:\Users\Steven\Desktop\复盘\网状模型.png)

#### 关系模型

**定义**

![image-20210119175109302](C:\Users\Steven\Desktop\复盘\关系模型.png)



三要素

* 数据结构
* 数据操作
* 完整性约束



**数据结构**

数据结构指数据对象与对象之间联系的表达，是系统的静态描述包括两个方面

数据本身：类型、内容、性质。例如关系模式中的域、属性、关系等

数据之间的关系：数据之间是如何相互联系的，如关系的主码、外码等



**数据操作**

对数据库中对象（型）和实例（值）允许执行的操作集合。主要是检索和更新（插入、删除、修改）两类操作。数据操作是对系统动态特征的描述

**完整性约束**

是一组完整性规则的集合，规定数据库状态以及状态变化所应满足的条件，以保证数据的正确性，相容性，有效性。包括了用户自定义完整性和实体完整性

实体完整性：若属性A为基本关系R的主属性，则A不能为空

参照完整性：若F为基本关系R的一个或一组属性，但不是主属性，Ks是基本关系S的主码，如果F与Ks对应，则称F是R的外码，并称基本关系R为参照关系，基本关系S为被参照关系

用户自定义完整性：针对用户的不同需求



**优缺点**

![image-20210119175149316](C:\Users\Steven\Desktop\复盘\关系模型优缺点.png)



## 关系数据库设计理论

### 函数依赖

### 范式





## 数据库管理系统组成

### 概要

![image-20210115223554905](C:\Users\Steven\Desktop\复盘\数据库管理系统流程图.png)

数据库系统划分为不同的模块。每个模块完成系统的一个功能。数据库系统的功能部件大致可分为存储管理器和查询处理器。

查询处理器：用于帮助数据库系统简化和方便数据访问。

存储管理器：负责在数据库中存储的低层数据与应用程序以及向系统提交的查询之间提供接口的部件。存储管理器负责与文件管理器进行交互。原始数据通过操作系统提供的文件系统存储在磁盘上。磁盘管理器将各种DML语句翻译为底层文件系统命令。因此，存储管理器负责数据库中数据的存储、检索和更新



### 查询处理器



### 存储管理器

#### 事务管理器

作用：保证即使发生了故障，数据库也保持在一致的（正确的）状态，并保证并发事物的执行不发生冲突



#### 文件管理器

管理磁盘存储空间的分配，管理用于表示磁盘上所存储信息的数据结构



#### 权限和完整性管理器

检测是否满足完整性约束，并检测试图访问数据的用户的权限



#### 缓冲区管理器

负责将数据从磁盘上取到内存中来，并决定哪些数据应被缓冲存储在内存中。



### 磁盘管理









# SQL

## 性能分析

#### Explain

**作用**

* 表的读取顺序（id）
* 数据读取的操作类型（select_type）
* 查询表用了什么类型（type）
* 使用的索引（key）



![](C:\Users\Steven\Desktop\复盘\Explain表头.png)

**id**

执行优先级

* id相同，执行顺序由上到下
* id不同，大的先执行



**select_type**

查询类型

* SIMPLE：简单的SELECT查询，查询中不包含子查询或者join
* PRIMARY：查询中若包含任何复杂的子部分，最外层的表标记的
* SUBQUERY：在SELECT或WHERE列表包含了子查询
* DERIVED：在FROM列表中包含的子查询被标记为DERIVED（衍生），MySQL会递归执行这些子查询，把结果放在临时表里
* UNION：若第二个SELECT出现在UNION之后，会被标记为UNION
* UNION RESULT：UNION合并的结果集



**table**

表名



**type**

显示查询用了何种类型

从好到差依次为

system>const>eq_ref>ref>range>index>ALL

* system：表中只有一行记录
* const：表示通过索引一次就找到了
* eq_ref：唯一性索引扫描，对于每个索引键，表中只有一条记录与之匹配
* ref：非唯一性索引扫描，返回匹配某个单独值的所有行
* range：只检索给定范围的行，使用一个索引来选择行
* index：全索引扫描，index与ALL区别为index类型只遍历索引树
* ALL：全表扫描



**possible_keys**

显示可能应用到这张表的索引



**key**

实际使用的索引



**key_len**

表示索引中使用的字节数



**ref**

显示索引的哪一列被使用了，如果可能的话，是一个常数。





**rows**

每张表有多少行被优化器查询







# MySQL

MySQL 是一个关系型数据库管理系统，开源免费，且易扩展，是当前最流行的关系型数据库管理系统之一，在 Java Web 应用方面的应用十分广泛。其默认端口为 **3306**。

![image-20210119164302804](C:\Users\Steven\Desktop\复盘\mysql体系结构.png)





## 索引

### 概念

什么是索引？为什么使用索引？

索引用于快速找到某个列中有一特定值的行，当表中的记录过大，不使用索引，MySQL必须从第一条记录开始读完整个表，直到找到相关的行，查询所花费的时间会增大。如果表中查询的列有一个索引，MySQL就能快速到达一个位置去搜索数据文件，而不必查看所有数据，那么对于查询数据库将会节省很多时间

本质：索引的本质数据结构，在特定场景下利用适合的高效的数据结构来让查询变得高效（空间换时间）





### 分类

按原理分类，索引分为以下几类

* 顺序索引
* 散列索引
* 位图索引



从MySQL的应用角度，索引分为以下几类

* 单列索引
* 联合索引
* 全文索引
* 空间索引



顺序索引中，又有以下几种分类

* 聚集索引/非聚集索引
* 稠密索引/稀疏索引
* 多级/单级索引
* 多码/单码索引



顺序索引中，按索引文件分类

* 索引顺序文件
* B+树索引文件



**聚集索引/非聚集索引**

搜索码：是任何一个属性或者属性的集合，它没必要是主码，甚至是超码。

索引结构：每个索引记录都包含搜索码及其搜索码相关联的记录

聚集索引：也叫做主索引，被索引文件顺序与索引结构中搜索码的顺序相同

非聚集索引：也叫做辅助索引，被索引文件顺序与索引结构中搜索码的顺序不同



**稠密索引/稀疏索引**

稠密索引：每个搜索码值都有一个索引项，辅助索引一定是稠密索引

稀疏索引：只为搜索码的某些值建立索引项





**索引顺序文件**

假定所有文件按某些搜索码顺序排序，这种搜索码上有聚集索引的文件成为索引顺序文件

![image-20210120180835365](C:\Users\Steven\Desktop\复盘\顺序索引文件.png)





### 实现原理

**磁盘结构**

* 数据库的数据存储在磁盘，以实现持久化
* 硬盘划分为磁头（Heads）、柱面（Cylinder）、扇区（Sector）
* 磁头：每张磁片正反两面各有一个磁头，一个磁头对应一张磁片的一个面
* 柱面：所有磁片中，**半径相同的同心磁道**构成柱面
* 扇区：将磁道划分为若干个小的区段，就是扇区

![](https://img-blog.csdn.net/2018071121421234?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQ0NzAzNjE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

![](https://img-blog.csdn.net/20180711214220194?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQ0NzAzNjE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

![](https://img-blog.csdn.net/20180711214524523?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTQ0NzAzNjE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

* 磁盘最小的存储单元为扇区，而数据就存储在这里，扇区的大小一般为512kb，具体大小由磁盘厂商定制

**磁盘读写操作**

磁盘的读写是根据主机访问磁盘地址实现的（磁头号、柱面号、扇区号），读写操作过程如下

1. 寻道：磁盘控制器将磁盘地址送到磁盘地址寄存器中，便产生了寻道命令，控制器选择指定的磁头移动到指定的柱面。
2. 旋转等待操作：盘片旋转时，会将扇区地址和磁盘地址寄存器进行比较找到符合的扇区
3. 读写操作：磁盘符合信号送给磁盘控制器，就开启读写控制。

**磁盘性能指标**

磁盘读写操作需要经过寻道、旋转等待、读写操作

因此响应时间=排队延迟+控制器时间+寻道时间+旋转等待时间+数据传输时间

* 一次存储时间大约需要10ms，非常慢！
* 磁盘读取数据，是以块为单位载入内存当中



**数据库文件**

假设数据库表为一个文件，这张表的每一条记录为定长记录，这些记录都会映射到磁盘块上，这个记录数如果很庞大，用户需要查询数据时，从头到尾读取时，需要把相应的磁盘块载入到内存中，这样查询的时间大多都耗费在I/O操作上，为了提高性能，采用索引的方式，建立一个数据结构包含了索引号和对应记录的指针，索引号按顺序排列，查询数据库时只需要载入索引表，进行二分查找，找到相应的索引号对应的记录，然后载入记录所在的磁盘块到内存即可，由于索引表比记录表小的多，那么就能够减小I/O操作消耗的时间，提高性能。



**多级索引**

当索引表过大时，查询的时间又会消耗在I/O操作上，采用类似的思路对索引表再建立索引的方式，先对外层索引记录下一级索引的范围，采用二分的方式，就能进一步减少I/O操作时间

![](C:\Users\Steven\Desktop\复盘\多级索引.png)

**二叉搜索树**

多级索引最大的缺点是不灵活，（数组）插入和删除和操作时间复杂度过高，为了在数据插入和删除的情况下仍然能保持其执行效率，采用二叉搜索树的方式来存储索引，但是二叉搜索树有可能退化成链表，查询时间复杂度就又变高



**平衡树AVL和红黑树**

为了使二叉树平衡，采用平衡二叉树来作为索引的数据结构，AVL树是高度平衡的二叉树，通过左旋和右旋来使得每个节点的平衡因子不超过1，为了维持这个性质，会耗费更多的时间来调整树的结构。

// TODO 红黑树



**B树**

B树是一颗多路平衡树，一颗m阶的B树定义如下

1. 一个节点最多有m-1个关键字，最多m个孩子结点
2. 非根节点至少$\lceil m/2 \rceil - 1$个关键字
3. 除非整棵树只有一个结点，否则根结点必须至少包含两个指针
4. 所有节点的关键字都按从小到大顺序排列
5. 所有叶子节点都位于同一层

通过分裂、合并、上移、下移操作来完成树的平衡

B树与红黑树相比是矮（深度小）胖（一个节点存储的关键字多）

每个节点有多个关键字，将一个节点设计为一个页（磁盘每次读取到大小相等的块到内存，每个块成为一个页），这样节点只需一次IO就可以完全载入，利用B树矮的特点，就可以减少IO读写来提高性能



**B+树**

结构与B树类似，除此之外还有以下要求

* 每个叶子节点都存有相邻叶子节点的指针，按叶子节点的关键字从小到大顺序连接
* 非叶子节点不存数据，只有索引，叶子节点存储数据和索引

使用B+树的原因

* B+树的非叶子节点由于不存储数据，在与B树节点相同的大小下，能存储更多的关键字，与B+树相比深度会更矮，IO操作代价会更低
* 由于数据都存在叶子节点，叶子节点的深度都相同，因此每次查询时更加稳定
* 由于叶子节点有到相邻节点的指针，因此范围查找时不用从根节点出发重新遍历，而是直接从叶子节点出发，减少了IO操作，有效提高了范围查找的效率



[MySQL索引背后的数据结构及算法原理](http://blog.codinglabs.org/articles/theory-of-mysql-index.html)





**MySQL索引实现**





### 应用

```mysql
SHOW INDEX FROM table_name;
```

![](C:\Users\Steven\Desktop\复盘\showIndex.png)

* Non_unique：是否为唯一索引
* Key_name：索引名字
* Column_name：列的名字
* Index_type：索引的类型



#### 单列索引

一个索引只包含一个列

**主键索引**

特殊的索引，不允许有空值。InnoDB下建表时会默认建立主键索引



**唯一索引**

唯一索引的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一。

```mysql
ALTER TABLE table_name ADD UNIQUE(column);
```



**普通索引**

最基本的索引，没有任何限制。

```mysql
ALTER TABLE table_name ADD INDEX index_name(column);
```



#### 联合索引

在表中的多个字段组合上创建的索引，只有在查询条件中使用了这些字段的左边字段时，索引才会被使用，使用组合索引时遵循最左前缀集合。

回表：先索引扫描，然后通过主键去取索引中未能提供的数据



**用法**

```mysql
ALTER TABLE table_name ADD INDEX index_name(column1, column2, column3)
```

**意义**

1. 减少开销。建一个联合索引（col1，col2，col3）实际相当于建了（col1），（col1，col2），（col1，col2，col3）三个索引。对于大量数据的表，使用联合索引会大大的减少开销。
2. 覆盖索引。如果查询的列和联合索引的列相同，那么可以直接通过遍历索引取得数据，而无需回表。
3. 效率高。索引列越多，通过索引筛选出的数据越少。



**使用场景**

联合索引的目的就是为了提高存在多个查询条件情况下的效率



**最左匹配原则**

联合索引是一个有序的元组，假如索引列分别为A，B,，C，顺序也是A，B，C

* 查询的时候，如果查询【A】【A,B】【A,B,C】那么可以通过索引查询
* 如果查询的时候，采用【A,C】那么只能用【A】索引
* 如果查询的时候【B】【B,C】【C】，最左前缀不匹配，那么后面的索引就用不到了





#### 全文索引

只有在MyISAM引擎上才能使用，只能用于CHAR,VARCHAR,TEXT类型字段。用于在一堆文字中，通过某个关键字找到该字段所属的行。

索引一经创建不能修改，只能删除重建。

```mysql
ALTER TABLE table_name ADD FULLTEXT(column);
```







#### 空间索引

空间索引是对空间数据类型的字段建立的索引，MySQL中的空间数据类型有四种，GEOMETRY,POINT,LINESTRING,POLYGON，创建空间索引时，使用SPATIAL关键字。要求存储引擎为MyISAM，船舰空间索引的列，必须将其声明为NOT NULL。







### 评价

使用索引的优缺点

* 减少了查询需要扫描的数据量
* 将服务器的随机IO变成了顺序IO
* 减少服务器的排序操作和创建临时表的速度（加快了GROUPBY和ORDERBY操作）

缺点

* 索引会带来额外的空间存储，其次在更新、删除操作，需要维护索引，带来了额外的时间开销



#### 使用原则

为什么不对表中每一个列创建一个索引呢？

* 创建索引和维护索引要耗费时间，这种时间会随着数据量的增加而增加
* 索引需要占用空间

不是每一个字段都设置索引就好，也不是索引越多越好，而是需要合理的使用

* 对于需要经常更新的表需要避免使用过多的索引，对于经常需要查询的字段应该创建索引
* 数据量小的表不必要使用索引，因为数据较少，查询全部数据花费的时间可能比遍历索引的时间还要短，索引就不会产生优化效果
* 在一同值少的字段上不要建立索引，比如学生表性别字段上只有男女两个不同的值。



#### 设计原则

* 适合索引的列是出现在where子句中的列，或者连接子句中指定的列
* 使用短索引，对过对长字符串列进行索引，应该指定一个前缀长度，这样能节省大量索引空间
* 不要过度索引。







#### 失效场景





### 优化









## 事务





## 存储引擎

### InnoDB



### MyISAM

### NDB

### Memory





| 功能         | InnoDB | MyISAM | Memory |
| ------------ | ------ | ------ | ------ |
| 存储限制     |        |        |        |
| 支持事务     |        |        |        |
| 支持全文索引 |        |        |        |
| 支持B树索引  |        |        |        |
| 支持哈希索引 |        |        |        |
| 支持集群索引 |        |        |        |
| 支持数据索引 |        |        |        |
| 支持数据压缩 |        |        |        |
| 空间使用率   |        |        |        |
| 支持外键     |        |        |        |





## 锁





## 优化









# 问题集

索引

那你能说说索引吗？它是用什么样的数据结构实现的？ 

那你说说B+树的高度以及查找的时间复杂度？ 

那这里为什么不用B树？B树和B+树的区别是什么？ 

MySQL的索引(B+和B树的区别，为啥用B+)；

索引的数据结构（B+树）、索引优缺点 

面试官说能从底层讲一下吗，提示聚簇索引。 

索引作用？索引的数据结构

为什么索引使用B+树结构，而不是B树 {B+树叶子结点}

为什么索引使用B+树结构，而不是[红黑树]() ： { 磁盘预读取 、[红黑树]()高度 }



联合索引

聚簇索引和非聚簇索引

联合索引最多多少个字段

 在设计联合索引需要注意什么 

 联合索引最左原则的底层原理 

联合索引底层原理+最左匹配原则？

最左匹配原则 







索引失效什么情况？

怎么设计索引？

DBA不知业务的情况下怎么设计索引？

 我说UUID索引查找效率不高，自增id插入效率受数据库影响性能 



 几千万的表要怎么设置索引？我说分表？没有经历过 

 说说索引失效场景：最左匹配LIKE % 、函数（还有吗） 



最左前缀原则、索引优化 

聚簇索引、覆盖索引 



聚簇索引是什么？

innodb是什么索引？

查字典是什么索引？

 聚簇索引和非聚簇索引如何加锁？ 

 (蒙了蒙了，彻底蒙了。。。。)

Innodb，B+树，聚簇索引和非聚簇索引区别 

 一千万条数据，问 b+ 数大概多高 





聚簇索引和非聚簇索引区别？ 主键索引和二级索引了解吗？  

为什么不对每个列创建索引呢？

mysql索引，再谈了谈高并发下B+树的优越性

mysql的查询，怎么判断有没有使用到索引（explain）

索引作用，失效的场景 

```
索引用来在大量数据中快速定位到我们想要查找的数据` `1``.like 以%开头，索引无效``2``.or语句前后没有同时使用索引``3``.单独引用复合索引里非第一位置的索引列``4``.数据类型出现隐式转化。如varchar不加单引号的话可能会自动转换为``int``型``5``.当全表扫描速度比索引速度快时，mysql会使用全表扫描，此时索引失效
```



非聚簇索引存了啥？如何避免回表?

讲讲数据库的索引？

你了解什么索引？什么时候索引会失效？

什么时候用哈希索引

一级索引二级索引（簇族索引和非簇族索引区别，答了一个物理顺序和逻辑顺序一致，问就这样吗）

为什么是最左匹配

hash索引和b+索引分别用在哪个存储引擎

B+树和hash索引

怎么利用索引来进行查询

最左前缀

什么时候不该使用索引？

聚集索引和非聚集索引的区别 

数据库索引数据结构？各种索引失效的情况？









事务













mysql设计表时怎么去提高性能

数据库范式 ？BCNF？第四第五范式？

limit优化

数据库的事务隔离级别

mvcc机制聊一下

Innodb 是如何解决幻读的

事务的实现原理

mvcc 的作用

数据库 有什么log ？

MySQL的自增id换为UUID会有什么问题（这个没有理解到位 

 慢查询怎么处理？打开MySQL的慢查询日志，看看慢查询。 

 MySQL默认事物隔离级别：RR 

 RR能解决幻读吗？不能 

 这里讲了一下MVCC 

 [项目]()实际怎么解决幻读：锁 select for update 

 Innodb锁有什么：表锁、行锁、间隙锁、the next key lock 

 间隙锁能详细说说吗：谈到了一个范围加锁、开闭区间

你了解MySQL数据库吗？ 

你能说说MyISAM和InnoDB之间的一些异同点吗？ 

说说InnoDB的事务隔离级别。脏读和幻影读的区别是什么？

当数据量变大了的时候，用MySQL该怎么解决（分库分表） 

当单纯升级机器和带宽不行了的时候，你会怎么设计一个能尽可能实时响应的MySQL系统？ 

你这样的设计过于依赖核心机器，有什么想法能够摆脱这种依赖？（分布式系统实在是不会，开始胡言乱语） 

字节的推送系统有亿级用户的数据量和推送请求，你觉得需要用什么系统？

手撕SQL语句 

数据库事务、隔离级别、Innodb和Myisam的区别 

锁机制（悲观锁、乐观锁、行锁表锁、独占锁共享锁等等） 

MVCC、NK-Lock 

数据库三大范式

主从复制、主从一致、分库分表等等问题

mysql主从复制的同步方式有几种？

char和varchar区别？

关系型数据库和非关系型数据库区别？

Innode引擎都知道什么？ 

事务的底层是怎么实现的？ 

binlog中都有啥？如何回滚，如何提交？ 

mvcc解决了什么问题？ 

如果只有一条select语句，它加锁吗？ 

如果一条delete语句，如何加锁？ 

主键加锁吗？ 

mvcc知道吗？解决什么问题？

幻读和脏读的区别

脏读是更新时产生的？幻读是添加时产生的吗？

 mysql 的 MVCC 以及是否解决幻读 

 手写sql，实现一个 按时间降序的分页查询 

 redo log，bin log，undo log



【高频】MyISAM 和 InnoDB的区别  ： {是否支持行锁 、 是否支持十五 、 是否支持 MVCC 、 底层索引结构不同 }

事务特性ACID 

深入一些 ： 为什么要有一致性 ？ AID不是已经保证了一致性了吗 ？ 

并发事务带来的问题 ： {  脏读 、 修改丢失 、 不可重复读 、 幻影读  }

【高频】事务的隔离级别 

【高频】 MVCC机制 



【高频】SQL语句优化 ，SQL题目（字节要求撸代码）



explain中 rows type key extra字段的含义？

11. count(1) count(*) count(列值)的区别

mysql：
什么是事务，事务的四大特性



5、mysql隔离级别（答了RC、RR、序列化，讲了一下innodb下RR级别咋解决幻读问题）

[复制代码](#)

```
RR解决幻读``间隙锁：对数据进行条件，范围检索时，对其范围内也许并存在的值进行加锁``针对当前读，RR隔离级别保证对读取到的记录加锁 (记录锁)，同时保证对读取的范围加锁，新的满足查询条件的记录不能够插入 (间隙锁)，不存在幻读现象
```

8.问你最后一个left join、right join和自然连接的区别

[复制代码](#)

```
Inner join 内连接，在两张表进行连接查询时，只保留两张表中完全匹配的结果集` `left join 在两张表进行连接查询时，会返回左表所有的行，即使在右表中没有匹配的记录。` `right join 在两张表进行连接查询时，会返回右表所有的行，即使在左表中没有匹配的记录。` `自然连接，针对相同表的  mysql会根据多个表内的相同字段作为连接条件``条件：``1``)两张连接的表中列名称和类型完全一致的列作为条件``2``)多个列名相同时，列的值也要同时相同才会连接出查询数据
```





Having作用 

[复制代码](#)

```
来过滤由GROUP BY语句返回的记录集(对分组后结果过滤，可以使用聚合函数如(max、min))``SELECT id, COUNT(course) as numcourse, AVG(score) as avgscore``FROM student``GROUP BY id``HAVING AVG(score)>=``80``;
```

mysql是如何实现事务的（redo log，undo log和锁）

mysql创建索引的注意事项

 

WAL知道吗？哪个log用了这个？那顺便介绍下三大log?  

一条sql执行很慢，怎么查？分析可能的原因？

mysql的三大log?

说说InnoDB的吧

四种隔离级别说说吧，怎么实现的？

哪种会产生幻读？怎么解决？

SQL注入了解吗？怎么防止？

mysql集群 如果写数据的话 你要怎么做

模糊查询是怎么做的

数据库

三大范式，事务、事务隔离级别、索引、索引优化、分库分表、存储引擎等，推荐书籍（高性能MySQL）

mysql分库分表

mysql索引类型

mysql分页查询





Mysql主从复制

Mysql读写分离





数据库事务有哪些特性

Mysql事务的是实现原理

Mysql索引

Mysql隔离级别

数据库读写分离原理

Mysql 

数据库事务有哪些特性

脏读和幻读的区别是什么？

可重复读的隔离级别下如何保证不幻读

非关系型数据库和关系型数据库的区别

Mysql mvcc？

乐观锁与悲观锁的区别

数据库范式讲一下

主键是什么？

内连接 左连接 右连接

union与union all的区别

Explain



数据库怎么优化

Mysql知道几种存储引擎，有什么区别 

覆盖索引 

主从复制、读写分离、分库分表 

Mysql锁划分 

Mysql架构 

in和exist区别



数据库的四个特性？四个隔离机制？ 

MySQL主从复制的原理？ 

MySQL的如何保证事务 

MVCC底层实现 

MySQL和Redis的区别（各自使用的场景以及原因） 

Innodb和MyISAM的区别 

 一条sql语句的查询流程

